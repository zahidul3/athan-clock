

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OAD Image Header &mdash; SimpleLink™ CC26x2 TI Thread User&#39;s Guide 1.02.00.00 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="SimpleLink™ CC26x2 TI Thread User&#39;s Guide 1.02.00.00 documentation" href="../index.html"/> 
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug oad-ble3 image-header";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script> 

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8">     



  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">
  <header id="tiHeader">
    <div class="top">
      <ul>
        <li id="top_logo">
          <a href="http://www.ti.com">
            <img src="../_static/img/ti_logo.png"/>
          </a>
        </li>
      </ul>
    </div>
    <div class="nav"></div>
  </header>
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../thread/index-cc26x2.html" class="icon icon-home"> SimpleLink™ CC26x2 TI Thread User's Guide
          

          
          </a>

          
            
            
              <div class="version">
                1.02.00.00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../thread/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc26x2/index-thread.html">CC26x2 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/ot-sw-dev-env.html">TI-OpenThread Stack Software Development Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/ot-stack-overview.html">TI-OpenThread Stack Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/running-example-apps-cc26x2.html">Example Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-br/index.html">Linux Border Router Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/creating-custom-apps.html">Creating Custom Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/custom-hardware.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/packet-sniffer.html">Packet Sniffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugging/thread-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-oad/index.html">Over-the-Air Download (OAD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/migration.html">Migration Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../thread/index-cc26x2.html">SimpleLink™ CC26x2 TI Thread User's Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../thread/index-cc26x2.html">Docs</a> &raquo;</li>
      
    <li>OAD Image Header</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="oad-image-header">
<span id="sec-oad-image-image-header"></span><span id="sec-oad-image-header"></span><h1>OAD Image Header<a class="headerlink" href="#oad-image-header" title="Permalink to this headline">¶</a></h1>
<p>All firmware images delivered via OAD are in binary format and contain an image
header. The information in the image header is used by the application and
BIM to determine the suitability of an image for download or loading. In order
to prevent this information from being calculated multiple times
all TI OAD images use a standard image header.</p>
<p>This section explains the various fields within the image header and what they
mean.</p>
<p>TI provides a tool to generate an OAD ready image, it is called
<a class="reference internal" href="../oad/tools.html#sec-generating-image-header-vector"><span class="std std-ref">OAD Image Tool</span></a>. By default, this tool runs as a
post-build step of all OAD enabled projects.</p>
<div class="section" id="oad-image-header-overview">
<h2>OAD Image Header Overview<a class="headerlink" href="#oad-image-header-overview" title="Permalink to this headline">¶</a></h2>
<p>The OAD image header is made up of two parts:</p>
<blockquote>
<div><ul class="simple">
<li>The core image header which is fixed and mandatory for all OAD images</li>
<li>The image segments which are optional and used to describe specific types
of images</li>
</ul>
</div></blockquote>
<p>The OAD image header is composed of a core header and segments. The core header
is required and common to all OAD image headers. The image segments are optional
and may be different for a given OAD use case (i.e. on-chip vs off-chip OAD).</p>
<p>The image below illustrates the makeup of an image header, and compares two
types. When added to an image by the
<a class="reference internal" href="../oad/tools.html#sec-oad-tools"><span class="std std-ref">OAD Image Tool</span></a> the OAD core header and segments are packed together
sequentially.</p>
<img alt="../_images/ditaa-ef3149c10037de59f24e8a673d6d061633efefe1.png" src="../_images/ditaa-ef3149c10037de59f24e8a673d6d061633efefe1.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In general it is not necessary for the customer or user to manually add or
modify segments. The segments should be populated and packed out of the
box by the TI oad_image_tool. The images above show a sampling of the
potential image header + segment configurations. All potential
configuratiions are not shown, depending on the selected build configuration
and project, the segments present may be different.</p>
</div>
</div>
<div class="section" id="oad-core-image-header">
<h2>OAD Core Image Header<a class="headerlink" href="#oad-core-image-header" title="Permalink to this headline">¶</a></h2>
<p>The core header contains the essential information required for all types of OAD
across all supported wireless stacks. The core header must be present as the
BIM relies heavily on it to boot and OAD image.</p>
<p><a class="reference internal" href="../oad/image-header.html#tbl-image-header-description-table"><span class="std std-numref">Table 1.</span></a> below shows a description of the
core image header.</p>
<span id="tbl-image-header-description-table"></span><table border="1" class="docutils" id="id3">
<caption><span class="caption-text">Description of the core image header.</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="31%" />
<col width="18%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Size (in bytes)</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>OAD Image Identification Value</td>
<td>8</td>
<td>Unique number to identify the start of an OAD image</td>
</tr>
<tr class="row-odd"><td>CRC</td>
<td>4</td>
<td>Cyclic Redundancy Check</td>
</tr>
<tr class="row-even"><td>BIM Version</td>
<td>1</td>
<td>Version required to support image format</td>
</tr>
<tr class="row-odd"><td>Image Header Version</td>
<td>1</td>
<td>Version of image header contained in image</td>
</tr>
<tr class="row-even"><td>Wireless Technology</td>
<td>2</td>
<td>Type of connectivity used in image</td>
</tr>
<tr class="row-odd"><td>Image Information</td>
<td>4</td>
<td>Image information bytes</td>
</tr>
<tr class="row-even"><td>Image Validation</td>
<td>4</td>
<td>Check if image is valid to run</td>
</tr>
<tr class="row-odd"><td>Image Length</td>
<td>4</td>
<td>The total length of the image including header</td>
</tr>
<tr class="row-even"><td>Program Entry Address</td>
<td>4</td>
<td>Application startup entry address</td>
</tr>
<tr class="row-odd"><td>Image Software Version</td>
<td>4</td>
<td>Software version of the image</td>
</tr>
<tr class="row-even"><td>Image End Address</td>
<td>4</td>
<td>End address of the image</td>
</tr>
<tr class="row-odd"><td>Header Length</td>
<td>2</td>
<td>Total length of the image header</td>
</tr>
</tbody>
</table>
<p>The core header is defined in <code class="docutils literal"><span class="pre">oad_image_header.h</span></code> in the struct
<code class="docutils literal"><span class="pre">imgFixedHdr_t</span></code>.</p>
<p>Each entry from <a class="reference internal" href="../oad/image-header.html#tbl-image-header-description-table"><span class="std std-numref">Table 1.</span></a> are described in
the following sections.</p>
<div class="section" id="oad-image-identification-value">
<h3>OAD Image Identification Value<a class="headerlink" href="#oad-image-identification-value" title="Permalink to this headline">¶</a></h3>
<p>The OAD Image Identification Value for the CC26x2 is set based on the
<code class="docutils literal"><span class="pre">DeviceFamily_*</span></code> defined that is provided by the SDK. The value is using the
the <code class="docutils literal"><span class="pre">OAD_IMG_ID_VAL</span></code> define. Note the protocol specific implementation OAD
should check that the <code class="docutils literal"><span class="pre">OAD_IMG_ID_VAL</span></code> field matches between the image
currently resident on the device and the incoming image.</p>
<p>The OAD Image Identification Value serves two purposes:</p>
<blockquote>
<div><ul class="simple">
<li>Provides the application a quick way to identify if it is receiving the
correct image.</li>
<li>Provides a means for the BIM to find the flash page containing the start
of OAD image for on-chip OAD</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is recommended that the customer customize the image identification
field to uniquely identify their product.</p>
</div>
</div>
<div class="section" id="crc">
<h3>CRC<a class="headerlink" href="#crc" title="Permalink to this headline">¶</a></h3>
<p>The cyclic redundancy check (CRC) is a means to check the integrity of an
image.  This must be done in two steps. First the CRC must be calculated when
the image is generated from the toolchain (by the <a class="reference internal" href="../oad/tools.html#sec-oad-tools"><span class="std std-ref">OAD Image Tool</span></a>), this
will be stored in the CRC field within the image header.</p>
<p>Later, once the target has received the OAD image, CRC will be recalculated to
determine if the image has been corrupted during transfer.</p>
<p>If the CRC is equivalent before and after the OAD, the target can assume that
the image was not corrupted while sending over the air.</p>
<p>A CRC-32 algorithm is used to calculate the CRC. This algorithm results in a 1
in 2<sup>32</sup> chance of collision. This allows for a 99.9999% error detection
rate.  In addition to this CRC, transfers through the protocol transport are
also protected by a CRC.  So the risk of an undetected data corruption is
reduced even further.</p>
</div>
<div class="section" id="bim-version">
<h3>BIM Version<a class="headerlink" href="#bim-version" title="Permalink to this headline">¶</a></h3>
<p>The BIM Version byte is used to determine whether or not the image is
compatible with the version of BIM that is running on the device.</p>
</div>
<div class="section" id="image-header-version">
<h3>Image Header Version<a class="headerlink" href="#image-header-version" title="Permalink to this headline">¶</a></h3>
<p>The image header Version byte is used to determine whether or image contains
image header that is compatible with the current version of the application and
BIM.</p>
</div>
<div class="section" id="wireless-technology">
<h3>Wireless Technology<a class="headerlink" href="#wireless-technology" title="Permalink to this headline">¶</a></h3>
<p>The Wireless Technology field in the image header describes what technology is
used in the image to be downloaded. Multiple technologies can be selected here
if the device used supports multiple technologies. These fields are added for
future expansion. Bits are set to 1 by default. To select the Wireless
Technology field, set the appropriate bit(s) to 0.</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Bit Number</th>
<th class="head">Type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>Bluetooth Low Energy</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>IEEE 802.15.4 (Sub 1GHz)</td>
</tr>
<tr class="row-even"><td>2</td>
<td>IEEE 802.15.4 (2.4GHz)</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>Zigbee</td>
</tr>
<tr class="row-even"><td>4</td>
<td>RF4CE</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>Thread</td>
</tr>
<tr class="row-even"><td>6</td>
<td>Easy Link</td>
</tr>
<tr class="row-odd"><td>7-15</td>
<td>Reserved</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="image-information">
<h3>Image Information<a class="headerlink" href="#image-information" title="Permalink to this headline">¶</a></h3>
<p>The Image Information provides details about the OAD image status and type. The
format is as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="16%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Byte Number</th>
<th class="head">Item</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>Image Copy Status</td>
<td><div class="first last line-block">
<div class="line">0xFF: Default status, no action needed</div>
<div class="line">0xFE: Image to be copied to on-chip flash at location indicated in the image header</div>
<div class="line">0xFC: Image copied</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>CRC Status</td>
<td><div class="first last line-block">
<div class="line">0xFC: CRC Invalid</div>
<div class="line">0xFE: CRC Valid</div>
<div class="line">0xFF: CRC Not Calculated Yet</div>
</div>
</td>
</tr>
<tr class="row-even"><td>2</td>
<td>Image Type</td>
<td><div class="first last line-block">
<div class="line">Device Images (0x00-0x15)</div>
<div class="line">0x00: Persistent application (for On-chip OAD)</div>
<div class="line">0x01: Application</div>
<div class="line">0x02: Stack</div>
<div class="line">0x03: Application &amp; Stack Merged</div>
<div class="line">0x04: Network Processor</div>
<div class="line">0x05: Factory Image</div>
<div class="line">0x06: BIM</div>
<div class="line">0x07: App &amp; Stack Combined (App/Stack_Library)</div>
<div class="line"><br /></div>
<div class="line">0x10-0x1F: User data</div>
<div class="line">0x20-0x3F: Host Processor Images</div>
<div class="line">0x40-0xFF: Reserved</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>Image Number</td>
<td><div class="first last line-block">
<div class="line">Image number if more than one type is stored</div>
<div class="line">0xFF: Default</div>
<div class="line">0x00-0xFE: Image number</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Image type 0x03 (Application &amp; Stack Merged) is different from 0x07 (App &amp;
Stack Combined). Image type 0x03 refers to the case where app and stack are
build as separate split images and combined using a hex merging tool. Image
type 0x07 refers to a app and stack being built as a single executable.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BIM will not try to interpret user data/application (anything with image
type &gt; 0x10).</p>
</div>
</div>
<div class="section" id="image-validation">
<h3>Image Validation<a class="headerlink" href="#image-validation" title="Permalink to this headline">¶</a></h3>
<p>The image validation field is currently not used and is reserved for future use.</p>
</div>
<div class="section" id="image-length">
<h3>Image Length<a class="headerlink" href="#image-length" title="Permalink to this headline">¶</a></h3>
<p>The Image Length field is the total length of the executable portion of the
image in bytes. Image length is calculated by the OAD image tool using the
following equation:</p>
<div class="math">
<p><img src="../_images/math/03e9417db29606bb09a50ad15d5c21c66e9670f3.svg" alt="\textrm{imgLen} = \textrm{imgEndAddr} - \textrm{imgStAddr} + 1"/></p>
</div><p>Note that the tool will pad the image length to be word aligned, updating the
length if needed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>imgEndAddr: Last used address in flash</li>
<li>imgStAddr: The first address used in flash (starts at <code class="docutils literal"><span class="pre">_imgHdr.imgID</span></code>)</li>
</ul>
</div>
</div>
<div class="section" id="program-entry-address">
<h3>Program Entry Address<a class="headerlink" href="#program-entry-address" title="Permalink to this headline">¶</a></h3>
<p>The Program Entry Address is a pointer to the application interrupt vector table
or application program entry address. This provides flexibility so that if the
program entry address changes between images, BIM will still be able to use this
field to run the application.</p>
</div>
<div class="section" id="software-version">
<h3>Software version<a class="headerlink" href="#software-version" title="Permalink to this headline">¶</a></h3>
<p>The Software Version field is used to keep track of the application and stack
revision contained in the image. This field follows the following format:</p>
<p>These values are assigned as shown in the table below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Byte Number</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>3-2</td>
<td>Stack version</td>
</tr>
<tr class="row-odd"><td>1-0</td>
<td>Application version</td>
</tr>
</tbody>
</table>
<p>For example an image with app version 1.0 and stack version 3.0 would be
designated as: <code class="docutils literal"><span class="pre">{'3',</span> <span class="pre">'0',</span> <span class="pre">'1',</span> <span class="pre">'0'}</span></code>. This field is to be set by the user in
their header implementation. (i.e. <code class="docutils literal"><span class="pre">oad_image_header*.c</span></code>)</p>
</div>
<div class="section" id="image-end-address">
<h3>Image End Address<a class="headerlink" href="#image-end-address" title="Permalink to this headline">¶</a></h3>
<p>The Image End Address is the last address in flash occupied by the image.</p>
</div>
<div class="section" id="header-length">
<h3>Header Length<a class="headerlink" href="#header-length" title="Permalink to this headline">¶</a></h3>
<p>The Header Length is the length of the core portion of the header. This is up to
and including the <code class="docutils literal"><span class="pre">rfu2</span></code> field in the structure defined in
<code class="docutils literal"><span class="pre">oad_image_header.h</span></code>.</p>
</div>
</div>
<div class="section" id="oad-image-header-segments">
<h2>OAD Image Header segments<a class="headerlink" href="#oad-image-header-segments" title="Permalink to this headline">¶</a></h2>
<p>The segment structure was designed to make the current OAD implementation
flexible and extensible. This makes it possible to expand the image header
vector as features are added to the OAD implementation without breaking the
existing system.</p>
<span id="tbl-image-header-description-segments-table"></span><table border="1" class="docutils" id="id4">
<caption><span class="caption-text">Description of the image header segments.</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="31%" />
<col width="18%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Size (in bytes)</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Boundary Information</td>
<td>24</td>
<td>Contains information about RAM and Flash boundaries</td>
</tr>
<tr class="row-odd"><td>Contiguous Image Information</td>
<td>12</td>
<td>Contains information about image to be downloaded</td>
</tr>
<tr class="row-even"><td>Security Information</td>
<td>85</td>
<td>Contains image signature and related information</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The current implementation only supports images of contiguous type, thus this
segment is required.</p>
<p class="last">The boundary segment is optional and only required for split image types.</p>
</div>
<div class="section" id="segment-header">
<h3>Segment Header<a class="headerlink" href="#segment-header" title="Permalink to this headline">¶</a></h3>
<p>Each segment has a common header structure. This is useful when parsing an image
for segments. The header structure is used by all segments. The common header
will be documented below so it does not have to be repeated for each segment
type.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="13%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Size (in bytes)</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Segment type = X</td>
<td>1</td>
<td>Segment header op-code</td>
</tr>
<tr class="row-odd"><td>Wireless technology</td>
<td>2</td>
<td>Same options as in the main wireless technology table above. Only one bit may be set here.</td>
</tr>
<tr class="row-even"><td>Reserved</td>
<td>1</td>
<td>Default is set to 0xFF</td>
</tr>
<tr class="row-odd"><td>Payload length</td>
<td>4</td>
<td>The length of the segment in bytes</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="section" id="segment-type">
<h4>Segment Type<a class="headerlink" href="#segment-type" title="Permalink to this headline">¶</a></h4>
<p>The segment type field is a one byte op-code that is useful in identifying the
segment type.</p>
</div>
<div class="section" id="id2">
<h4>Wireless Technology<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>This is the type of wireless technology that is contained in the segment. Each
segment may be built for only one wireless tech, thus only one bit can be set in
this field.</p>
</div>
<div class="section" id="reserved">
<h4>Reserved<a class="headerlink" href="#reserved" title="Permalink to this headline">¶</a></h4>
<p>This field is currently unused and existing designs should not rely on this
field.</p>
</div>
<div class="section" id="payload-length">
<h4>Payload Length<a class="headerlink" href="#payload-length" title="Permalink to this headline">¶</a></h4>
<p>The length of the entire segement in bytes.</p>
</div>
</div>
<div class="section" id="boundary-information-segment">
<h3>Boundary Information Segment<a class="headerlink" href="#boundary-information-segment" title="Permalink to this headline">¶</a></h3>
<p>The Boundary Information field is intended for split image type OAD
(where the application and stack are separate images) and is optional.
The boundary segment provides information to BIM on the flash and RAM boundaries
of the image and its associated wireless stack image.</p>
<p>This information is formatted in the following way:</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="13%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Item</th>
<th class="head">Size (in bytes)</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Segment type = 0</td>
<td>1</td>
<td>Tells the BIM that the following fields provide RAM and stack boundary information</td>
</tr>
<tr class="row-odd"><td>Wireless technology</td>
<td>2</td>
<td>Same options as in the main wireless technology table above. Only one bit may be set here.</td>
</tr>
<tr class="row-even"><td>Reserved</td>
<td>1</td>
<td>Default is set to 0xFF</td>
</tr>
<tr class="row-odd"><td>Payload length</td>
<td>4</td>
<td>The length of the boundary information field in bytes</td>
</tr>
<tr class="row-even"><td>Stack Entry Address</td>
<td>4</td>
<td>Stack entry address</td>
</tr>
<tr class="row-odd"><td>ICALL_STACK0_ADDR</td>
<td>4</td>
<td>Stack boundary address</td>
</tr>
<tr class="row-even"><td>RAM_START_ADDR</td>
<td>4</td>
<td>Start address of RAM</td>
</tr>
<tr class="row-odd"><td>RAM_END_ADDR</td>
<td>4</td>
<td>End address of RAM</td>
</tr>
</tbody>
</table>
<p>The boundary segment is defined in <code class="docutils literal"><span class="pre">oad_image_header.h</span></code> in the struct
<code class="docutils literal"><span class="pre">boundarySeg_t</span></code>. See this structure in Doxygen for more information.</p>
<div class="section" id="stack-entry-address">
<h4>Stack Entry Address<a class="headerlink" href="#stack-entry-address" title="Permalink to this headline">¶</a></h4>
<p>This is the entry point to the stack image, required when the app and stack are
of split image type.</p>
</div>
<div class="section" id="stack-boundary-address-icall-stack0-addr">
<h4>Stack Boundary Address (ICALL_STACK0_ADDR)<a class="headerlink" href="#stack-boundary-address-icall-stack0-addr" title="Permalink to this headline">¶</a></h4>
<p>The address of the app/stack boundary. This is the lowest address occupied by
the stack.</p>
</div>
<div class="section" id="lower-ram-boundary-ram-start-addr">
<h4>Lower RAM Boundary (RAM_START_ADDR)<a class="headerlink" href="#lower-ram-boundary-ram-start-addr" title="Permalink to this headline">¶</a></h4>
<p>The lower address of the RAM region reserved by the stack image.</p>
</div>
<div class="section" id="upper-ram-boundary-ram-end-addr">
<h4>Upper RAM Boundary (RAM_END_ADDR)<a class="headerlink" href="#upper-ram-boundary-ram-end-addr" title="Permalink to this headline">¶</a></h4>
<p>The upper address of the RAM region reserved by the stack image.</p>
</div>
</div>
<div class="section" id="contiguous-image-information-segment">
<h3>Contiguous Image Information Segment<a class="headerlink" href="#contiguous-image-information-segment" title="Permalink to this headline">¶</a></h3>
<p>The Continuous Image Information field provides information about the image to be
downloaded during the OAD process. The information is formatted in the following
way:</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="13%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Item</th>
<th class="head">Size (in bytes)</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Segment type = 1</td>
<td>1</td>
<td>Tells the BIM that the following fields provide information about the image payload</td>
</tr>
<tr class="row-odd"><td>Wireless technology</td>
<td>2</td>
<td>Same options as in the main wireless technology table above. Only one bit may be set here.</td>
</tr>
<tr class="row-even"><td>Reserved</td>
<td>1</td>
<td>Default is set to 0xFF</td>
</tr>
<tr class="row-odd"><td>Image Segment Len</td>
<td>4</td>
<td>The length of the continuous image segment in bytes</td>
</tr>
<tr class="row-even"><td>Image Start Address</td>
<td>4</td>
<td>Address of executable image data</td>
</tr>
</tbody>
</table>
<p>The contiguous image segment is defined in <code class="docutils literal"><span class="pre">oad_image_header.h</span></code> in the struct
<code class="docutils literal"><span class="pre">imgPayloadSeg_t</span></code>. See this structure in Doxygen for more information.</p>
<div class="section" id="image-start-address">
<h4>Image Start Address<a class="headerlink" href="#image-start-address" title="Permalink to this headline">¶</a></h4>
<p>The starting address of the contiguous image segment. The information in this
segment will be filled in sequentially from the start address.</p>
</div>
</div>
<div class="section" id="security-information-segment">
<span id="sec-oad-security-seg"></span><h3>Security Information Segment<a class="headerlink" href="#security-information-segment" title="Permalink to this headline">¶</a></h3>
<p>Images that are built using the secure OAD feature will contain a security
information segment as part of the image header. The format of the security
segment is shown below</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="13%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Item</td>
<td>Size(in bytes)</td>
<td>Description</td>
</tr>
<tr class="row-even"><td>Segment type = 3</td>
<td>1</td>
<td>Tells the BIM that this segment contains security info.</td>
</tr>
<tr class="row-odd"><td>Wireless technology</td>
<td>2</td>
<td>Same options as in main wireless technology table above. Only one bit can be set here.</td>
</tr>
<tr class="row-even"><td>Verification status</td>
<td>1</td>
<td>Default is set to 0xFF.
0xFC indicates that sign verification fails
0xFE indicates successful verification</td>
</tr>
<tr class="row-odd"><td>Payload len</td>
<td>4</td>
<td>The actual length of the security information bytes + length of the structure</td>
</tr>
<tr class="row-even"><td>Security payload</td>
<td>variable</td>
<td>Structure will include security algorithm type and data about its various components</td>
</tr>
</tbody>
</table>
<p>The security payload strcture is defined below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="23%" />
<col width="46%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Item</td>
<td>Size(in bytes)</td>
<td>Description</td>
</tr>
<tr class="row-even"><td>Version</td>
<td>1</td>
<td>0x1: ECC P-256 raw public key
0x2-0xFF: reserved</td>
</tr>
<tr class="row-odd"><td>Timestamp</td>
<td>4</td>
<td>Timestamp</td>
</tr>
<tr class="row-even"><td>certificate payload</td>
<td>Variable</td>
<td>8 byte signer info,
64 byte public key
See  <code class="docutils literal"><span class="pre">eccSignature_t</span></code></td>
</tr>
</tbody>
</table>
<p>The security structure is defined by <code class="docutils literal"><span class="pre">securityInfoSeg_t</span></code> in
<code class="docutils literal"><span class="pre">oad_image_header.h</span></code></p>
<div class="section" id="verification-status">
<h4>Verification status<a class="headerlink" href="#verification-status" title="Permalink to this headline">¶</a></h4>
<p>Tracks whether or not the BIM has verified the signature embedded in the image.
Once a signature has been checked and is validated or invalidated, the result
will be stored in the flag and not calculated again.</p>
</div>
<div class="section" id="security-version">
<h4>Security Version<a class="headerlink" href="#security-version" title="Permalink to this headline">¶</a></h4>
<p>Indicates which signing algorithm was performed on the image.
At this time only ECDSA P-256 signatures are supported. In the future other
algorithms may be supported, other values for the version field are considered
RFU.</p>
</div>
<div class="section" id="security-timestamp">
<h4>Security Timestamp<a class="headerlink" href="#security-timestamp" title="Permalink to this headline">¶</a></h4>
<p>Intended to provide a timestamp on an image to prevent relay attacks.
Not used at this time.</p>
</div>
<div class="section" id="certificate-payload">
<h4>Certificate Payload<a class="headerlink" href="#certificate-payload" title="Permalink to this headline">¶</a></h4>
<p>The certificate payload is a combination of two fields</p>
<blockquote>
<div><ul class="simple">
<li>Security signer information: 8 bytes of SHA2 hash</li>
<li>Image signature: 64 bytes of signature as calculated by ECDSA algorithm</li>
</ul>
</div></blockquote>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
      <a href="http://www.ti.com/corp/docs/legal/copyright.shtml">2016-2018, Texas Instruments</a>, Texas Instruments Incorporated. All rights reserved. <br>
      <a href="http://www.ti.com/corp/docs/legal/trademark/trademrk.htm">Trademarks</a> | <a href="http://www.ti.com/corp/docs/legal/privacy.shtml">Privacy policy</a> | <a href="http://www.ti.com/corp/docs/legal/termsofuse.shtml">Terms of use</a> | <a href="http://www.ti.com/lsds/ti/legal/termsofsale.page">Terms of sale</a>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.02.00.00',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
        });

      var menuHeight = window.innerHeight;

      var contentOffset = $(".wy-nav-content-wrap").offset();
      var contentHeight = $(".wy-nav-content-wrap").height();
      var contentBottom = contentOffset.top + contentHeight;

      function setNavbarTop() {
          var scrollTop = $(window).scrollTop();
          var maxTop = scrollTop + menuHeight;

          // If past the header
          if (scrollTop > contentOffset.top && maxTop < contentBottom) {
            stickyTop = scrollTop - contentOffset.top;
          } else if (maxTop > contentBottom) {
            stickyTop = scrollTop - contentOffset.top - (maxTop - contentBottom);
          } else {
            stickyTop = 0;
          }

          $(".wy-nav-side").css("top", stickyTop);
      }

      $(document).ready(function() {
        setNavbarTop();
        $(window).scroll(function () {
          setNavbarTop();
        });

        $('body').on("mousewheel", function () {
            // Remove default behavior
            event.preventDefault();
            // Scroll without smoothing
            var wheelDelta = event.wheelDelta;
            var currentScrollPosition = window.pageYOffset;
            window.scrollTo(0, currentScrollPosition - wheelDelta);
        });
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>